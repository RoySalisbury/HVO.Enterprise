# HVO.SkyMonitor Environment Variables Template
# Copy this file to .env for local development (git-ignored)
#
# Non-sensitive configuration values with defaults
# Override in .env file or environment for custom values

# Application Mode
USE_CONTAINERS=true

# ASP.NET Core Environment
ASPNETCORE_ENVIRONMENT=Development
DOTNET_ENVIRONMENT=Development

# Docker Configuration
DOCKER_HOST_ADDRESS=0.0.0.0
DOCKER_CONTEXT_PUBLIC_HOST_DEFAULT=localhost
#DOCKER_CONTEXT_PUBLIC_HOST_PROXMOX_HOME=192.168.2.104
#DOCKER_CONTEXT_PUBLIC_HOST_RPI_HOME=192.168.2.21

APPLICATIONINSIGHTS_CONNECTION_STRING=InstrumentationKey=461820e1-768d-49c2-9ffa-dcadc6f8076a;IngestionEndpoint=https://westus3-1.in.applicationinsights.azure.com/;LiveEndpoint=https://westus3.livediagnostics.monitor.azure.com/;ApplicationId=ffe9f937-60da-4b07-8645-88b24d8f5e4f

# =====================================================
# Docker Compose - Per-Service Docker Contexts
# =====================================================
# These variables allow services to run on different Docker hosts
# Default: "default" uses local Docker daemon
# Override to target remote Docker contexts (e.g., "remote-pi")
POSTGRES_DOCKER_CONTEXT=proxmox-home
MINIO_DOCKER_CONTEXT=proxmox-home
REDIS_DOCKER_CONTEXT=proxmox-home
SMTP_DOCKER_CONTEXT=proxmox-home
LOGICHOST_DOCKER_CONTEXT=default
CAMERAAGENT_DOCKER_CONTEXT=default

# Data directories for bind mounts (accessible from dev container)
POSTGRES_DATA_DIR=./data/postgres
MINIO_DATA_DIR=./data/minio
REDIS_DATA_DIR=./data/redis

# Infrastructure hosts (defaults target proxmox-home @ 192.168.2.104)
POSTGRES_HOST=192.168.2.104
POSTGRES_HOST_DEFAULT=postgres
#POSTGRES_HOST_RPI_HOME=192.168.2.21
REDIS_HOST=192.168.2.104
REDIS_HOST_DEFAULT=redis
#REDIS_HOST_RPI_HOME=192.168.2.21
MINIO_HOST=192.168.2.104
MINIO_HOST_DEFAULT=minio
#MINIO_HOST_RPI_HOME=192.168.2.21
SMTP_HOST=192.168.2.104
SMTP_HOST_DEFAULT=smtp
#SMTP_HOST_RPI_HOME=192.168.2.21

# Redis Configuration (non-sensitive)
REDIS_PORT=6379

# PostgreSQL Configuration (non-sensitive)
POSTGRES_PORT=5432
POSTGRES_DB=skymonitordb
POSTGRES_USER=skymonitor
POSTGRES_PASSWORD=skymonitor_dev_password

# MinIO Configuration (non-sensitive)
MINIO_API_PORT=9000
MINIO_API_PORT_DEFAULT=9000
MINIO_CONSOLE_PORT=9001
MINIO_ENDPOINT=192.168.2.104:9000
MINIO_ENDPOINT_DEFAULT=minio:9000
#MINIO_ENDPOINT_RPI_HOME=192.168.2.21:9000

# SMTP Configuration (non-sensitive)
SMTP_PORT=1025
SMTP_PORT_DEFAULT=1025
SMTP_WEB_PORT=8025

# Application Ports
LOGIC_HOST_HTTP_PORT=5174
LOGIC_HOST_HTTPS_PORT=7096
CAMERA_AGENT_HTTP_PORT=5130
CAMERA_AGENT_IDENTITY_PUBLIC_URL=http://localhost:5174
CAMERA_AGENT_IDENTITY_DB_PATH=/app/App_Data/identity/cameraagent_identity.db
IDENTITYSERVER_ISSUER=http://logichost:8080/

# Remote context overrides for the camera agent
# Values should point to whichever host/address makes `logichost` reachable from that docker context.
# Use uppercase context names with non-alphanumeric characters replaced by underscores (example: rpi-home => RPI_HOME)
CAMERA_AGENT_LOGIC_BASEURL_DEFAULT=http://logichost:8080
CAMERA_AGENT_IDENTITY_URL_DEFAULT=http://logichost:8080
# Example that targets a Raspberry Pi host running the logic service on HTTPS port 7096
#CAMERA_AGENT_LOGIC_BASEURL_RPI_HOME=https://192.168.1.42:7096
#CAMERA_AGENT_IDENTITY_URL_RPI_HOME=https://192.168.1.42:7096
#CAMERA_AGENT_IDENTITY_PUBLIC_URL_RPI_HOME=https://192.168.1.42:7096

# =====================================================
# Identity Hardening - Rate Limiting Configuration (non-sensitive)
# =====================================================
# Token endpoint rate limits (per IP address)
RATE_LIMIT_TOKEN_ENDPOINT_PERMITS_PER_MINUTE=60
RATE_LIMIT_TOKEN_ENDPOINT_QUEUE_LIMIT=10

# API endpoint rate limits (per authenticated user)
RATE_LIMIT_API_ENDPOINT_PERMITS_PER_MINUTE=1000

# Global rate limits
RATE_LIMIT_GLOBAL_PERMITS_PER_MINUTE=10000

# =====================================================
# Identity Hardening - Signed URL Configuration (non-sensitive)
# =====================================================
# Default TTL for signed URLs (seconds)
SIGNED_TICKET_DEFAULT_TTL_SECONDS=300

# Clock skew tolerance (seconds)
SIGNED_TICKET_MAX_CLOCK_SKEW_SECONDS=30

# Enforce allowed paths for signed URLs
SIGNED_TICKET_ENFORCE_ALLOWED_PATHS=true

# Allowed path prefixes (comma-separated)
SIGNED_TICKET_ALLOWED_PATHS=/api/v1.0/frame/,/api/v1.0/image/

# =====================================================
# Identity Hardening - Logging Configuration (non-sensitive)
# =====================================================
# Structured logging minimum level
LOGGING_LOGLEVEL_DEFAULT=Information
LOGGING_LOGLEVEL_MICROSOFT_ASPNETCORE=Warning

# =====================================================
# SECRETS - DO NOT SET IN THIS FILE
# =====================================================
# Set these via:
# - User Secrets (dotnet user-secrets set "KeyName" "value")
# - Environment variables in production
# - GitHub Secrets for CI/CD
# - Azure Key Vault for production deployments
#
# See docs/security/secrets.md for the comprehensive secret management guide

# =====================================================
# Infrastructure Secrets
# =====================================================

# MinIO Credentials (REQUIRED)
# MINIO_ROOT_USER=<your-minio-username>
# MINIO_ROOT_PASSWORD=<your-minio-password>

# PostgreSQL Credentials (REQUIRED for production)
# POSTGRES_USER=<your-postgres-username>
# POSTGRES_PASSWORD=<your-postgres-password>

# =====================================================
# Identity Hardening - Authentication & Authorization Secrets
# =====================================================

# OpenIddict Signing Certificate (Production only - Development uses auto-generated)
# OPENIDDICT_SIGNING_CERT_PATH=/path/to/signing-cert.pfx
# OPENIDDICT_SIGNING_CERT_PASSWORD=<secure-password>

# OpenIddict Encryption Certificate (Production only)
# OPENIDDICT_ENCRYPTION_CERT_PATH=/path/to/encryption-cert.pfx
# OPENIDDICT_ENCRYPTION_CERT_PASSWORD=<secure-password>

# Signed URL HMAC Secret (REQUIRED if using signed URLs - minimum 32 bytes)
# Generate with: openssl rand -base64 32
# SIGNED_TICKET_SECRET=<random-256-bit-base64-value>

# API Key Hashing Salt (Optional - for enhanced security)
# Generate with: openssl rand -base64 32
# API_KEY_HASHING_SALT=<random-256-bit-base64-value>

# =====================================================
# Identity Hardening - TLS/HTTPS Secrets (Production only)
# =====================================================

# HTTPS Certificate (Production only - Development uses dev cert)
# KESTREL_CERTIFICATES_DEFAULT_PATH=/path/to/cert.pfx
# KESTREL_CERTIFICATES_DEFAULT_PASSWORD=<cert-password>
# ASPNETCORE_HTTPS_PORT=443

# =====================================================
# Identity Hardening - Data Protection (Production only)
# =====================================================

# Azure Key Vault for Data Protection keys (Production only)
# DATA_PROTECTION_KEY_VAULT_URI=https://your-keyvault.vault.azure.net/
# DATA_PROTECTION_APPLICATION_NAME=HVO.SkyMonitor

# =====================================================
# Identity Hardening - Azure Integration (Production only)
# =====================================================

# Azure Key Vault access
# AZURE_CLIENT_ID=<service-principal-id>
# AZURE_TENANT_ID=<tenant-id>
# AZURE_CLIENT_SECRET=<service-principal-secret>
# KEY_VAULT_NAME=<your-keyvault-name>
